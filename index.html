<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Analytics - 2025 Performance + 2026 Projections</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Outfit:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --floral-white: #fffcf2;
            --light-orange: #ffa726;
            --bright-orange: #ff6f00;
            --deep-orange: #e65100;
            --navy-blue: #2c3e50;
            --dark-navy: #1a252f;
            
            --bg-primary: #fffcf2;
            --bg-secondary: #fff4e6;
            --bg-tertiary: #ffe0b2;
            --accent-primary: #ff6f00;
            --accent-secondary: #e65100;
            --text-primary: #2c3e50;
            --text-secondary: #546e7a;
            --border-color: #ffcc80;
        }
        
        body { font-family: 'Outfit', sans-serif; background: var(--bg-primary); color: var(--text-primary); }
        .app-container { min-height: 100vh; position: relative; }
        .background-grid { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: linear-gradient(var(--border-color) 1px, transparent 1px), linear-gradient(90deg, var(--border-color) 1px, transparent 1px); background-size: 50px 50px; opacity: 0.15; pointer-events: none; z-index: 0; }
        .content-wrapper { position: relative; z-index: 1; max-width: 1600px; margin: 0 auto; padding: 40px 20px; }
        .header { margin-bottom: 40px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; }
        .header-content { text-align: left; display: flex; align-items: center; gap: 20px; }
        .logo-img { height: 80px; width: auto; }
        .header-text { display: flex; flex-direction: column; }
        .header-content h1 { font-size: 3.5em; font-weight: 800; background: linear-gradient(135deg, var(--bright-orange), var(--navy-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; letter-spacing: -2px; }
        .header-content p { font-size: 1.1em; color: var(--text-secondary); font-family: 'JetBrains Mono', monospace; letter-spacing: 1px; }
        .upload-btn { background: linear-gradient(135deg, var(--bright-orange), var(--deep-orange)); color: var(--floral-white); border: none; padding: 14px 28px; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-family: 'Outfit', sans-serif; }
        .upload-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(255, 111, 0, 0.4); }
        .file-input { display: none; }
        .uploaded-files { margin-bottom: 30px; }
        .file-tag { display: inline-block; background: var(--bg-tertiary); border: 1px solid var(--border-color); padding: 8px 16px; border-radius: 20px; margin: 5px; font-size: 0.85em; font-family: 'JetBrains Mono', monospace; color: var(--bright-orange); }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary)); border: 1px solid var(--border-color); border-radius: 16px; padding: 30px; position: relative; overflow: hidden; transition: all 0.3s ease; }
        .stat-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, var(--bright-orange), var(--light-orange)); }
        .stat-card.highlight::before { background: linear-gradient(90deg, var(--navy-blue), var(--bright-orange)); }
        .stat-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(255, 111, 0, 0.15); }
        .stat-label { font-size: 0.85em; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 15px; font-weight: 600; }
        .stat-value { font-size: 2.5em; font-weight: 800; line-height: 1; background: linear-gradient(135deg, var(--bright-orange), var(--navy-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .stat-card.highlight .stat-value { background: linear-gradient(135deg, var(--navy-blue), var(--bright-orange)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .stat-change { font-size: 0.9em; color: var(--bright-orange); margin-top: 10px; font-family: 'JetBrains Mono', monospace; }
        .charts-container { display: grid; grid-template-columns: 1fr; gap: 30px; margin-bottom: 40px; }
        @media (min-width: 1024px) { .charts-container.two-col { grid-template-columns: repeat(2, 1fr); } }
        .chart-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 16px; padding: 30px; position: relative; }
        .chart-card.full-width { grid-column: 1 / -1; }
        .chart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .chart-title { font-size: 1.3em; font-weight: 700; color: var(--text-primary); }
        .chart-subtitle { font-size: 0.85em; color: var(--text-secondary); font-family: 'JetBrains Mono', monospace; }
        .chart-wrapper { position: relative; height: 400px; }
        .empty-state { text-align: center; padding: 100px 20px; color: var(--text-secondary); }
        .empty-state-icon { font-size: 5em; margin-bottom: 20px; opacity: 0.3; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animated { animation: fadeIn 0.5s ease forwards; }
        .rpu-badge { display: inline-block; background: linear-gradient(135deg, var(--bright-orange), var(--deep-orange)); color: var(--floral-white); padding: 4px 12px; border-radius: 12px; font-size: 0.7em; font-weight: 700; margin-left: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .tooltip-container { position: relative; display: inline-block; }
        .info-icon { display: inline-flex; align-items: center; justify-content: center; width: 18px; height: 18px; margin-left: 8px; background: var(--bright-orange); color: var(--floral-white); border-radius: 50%; font-size: 0.7em; font-weight: 700; cursor: help; transition: all 0.3s ease; }
        .info-icon:hover { background: var(--deep-orange); transform: scale(1.1); }
        .tooltip { visibility: hidden; opacity: 0; position: absolute; top: 125%; left: 50%; transform: translateX(-50%); background: var(--navy-blue); color: var(--floral-white); padding: 12px 16px; border-radius: 8px; font-size: 0.85em; white-space: nowrap; z-index: 1000; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(44, 62, 80, 0.3); font-family: 'JetBrains Mono', monospace; }
        .tooltip::after { content: ''; position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); border: 6px solid transparent; border-bottom-color: var(--navy-blue); }
        .tooltip-container:hover .tooltip { visibility: visible; opacity: 1; }
        .tooltip-multiline { white-space: normal; width: 280px; line-height: 1.5; }
        .tooltip-formula { font-weight: 700; color: var(--light-orange); display: block; margin-bottom: 6px; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        function BookingAnalyticsPlatform() {
            const [files, setFiles] = useState([]);
            const [data, setData] = useState([]);
            const fileInputRef = useRef(null);
            const combinedChartRef = useRef(null);
            const rpuChartRef = useRef(null);
            const vehicleChartRef = useRef(null);
            const trendChartRef = useRef(null);
            
            const combinedChartInstance = useRef(null);
            const rpuChartInstance = useRef(null);
            const vehicleChartInstance = useRef(null);
            const trendChartInstance = useRef(null);
            
            useEffect(() => {
                const initialData = [
                    { month: 'Jan', bookings: 18, revenue: 9858.44, uniqueVehicles: 14 },
                    { month: 'Feb', bookings: 19, revenue: 6485.07, uniqueVehicles: 15 },
                    { month: 'Mar', bookings: 55, revenue: 28650.57, uniqueVehicles: 18 },
                    { month: 'Apr', bookings: 45, revenue: 31465.56, uniqueVehicles: 19 },
                    { month: 'May', bookings: 51, revenue: 45000.36, uniqueVehicles: 20 },
                    { month: 'Jun', bookings: 49, revenue: 28352.12, uniqueVehicles: 18 },
                    { month: 'Jul', bookings: 55, revenue: 36015.33, uniqueVehicles: 19 },
                    { month: 'Aug', bookings: 35, revenue: 18917.10, uniqueVehicles: 16 },
                    { month: 'Sep', bookings: 36, revenue: 18652.72, uniqueVehicles: 15 },
                    { month: 'Oct', bookings: 32, revenue: 16618.74, uniqueVehicles: 14 },
                    { month: 'Nov', bookings: 6, revenue: 9023.71, uniqueVehicles: 6 }
                ];
                setData(initialData);
            }, []);
            
            useEffect(() => {
                if (data.length > 0) renderCharts();
            }, [data]);
            
            const handleFileSelect = (e) => {
                const selectedFiles = Array.from(e.target.files);
                handleFiles(selectedFiles);
            };
            
            const handleFiles = async (newFiles) => {
                const xlsxFiles = newFiles.filter(f => f.name.endsWith('.xlsx') || f.name.endsWith('.xls'));
                if (xlsxFiles.length === 0) {
                    alert('Please upload Excel files (.xlsx or .xls)');
                    return;
                }
                setFiles(prev => [...prev, ...xlsxFiles]);
                for (const file of xlsxFiles) await processFile(file);
            };
            
            const processFile = async (file) => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { type: 'array' });
                            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                            const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                            
                            let bookings = 0, revenue = 0;
                            const vehicleIds = new Set();
                            
                            for (let i = jsonData.length - 1; i >= 0; i--) {
                                const row = jsonData[i];
                                if (row[0] && String(row[0]).includes('Grand Total')) {
                                    bookings = parseInt(row[1]) || 0;
                                    for (let j = row.length - 1; j >= 0; j--) {
                                        if (typeof row[j] === 'number' && row[j] > 100) {
                                            revenue = row[j];
                                            break;
                                        }
                                    }
                                    break;
                                }
                            }
                            
                            for (let i = 8; i < jsonData.length; i++) {
                                const row = jsonData[i];
                                if (row[0] && String(row[0]).includes('Grand Total')) break;
                                if (row[6]) vehicleIds.add(String(row[6]));
                            }
                            
                            const uniqueVehicles = vehicleIds.size;
                            
                            if (bookings > 0 && revenue > 0) {
                                const monthMatch = file.name.match(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i);
                                if (monthMatch) {
                                    const month = monthMatch[1];
                                    setData(prev => {
                                        const filtered = prev.filter(d => d.month !== month);
                                        return [...filtered, { month, bookings, revenue, uniqueVehicles }].sort((a, b) => {
                                            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                                            return months.indexOf(a.month) - months.indexOf(b.month);
                                        });
                                    });
                                }
                            }
                        } catch (err) {
                            console.error('Error processing file:', err);
                        }
                        resolve();
                    };
                    reader.readAsArrayBuffer(file);
                });
            };
            
            const renderCharts = () => {
                const months = data.map(d => d.month);
                const revenues = data.map(d => d.revenue);
                const bookings = data.map(d => d.bookings);
                const rpuValues = data.map(d => d.revenue / d.uniqueVehicles);
                
                const calculate2026Projections = (values) => {
                    const n = values.length;
                    const x = Array.from({length: n}, (_, i) => i);
                    const sumX = x.reduce((a, b) => a + b, 0);
                    const sumY = values.reduce((a, b) => a + b, 0);
                    const sumXY = x.reduce((sum, xi, i) => sum + xi * values[i], 0);
                    const sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
                    const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
                    const intercept = (sumY - slope * sumX) / n;
                    return Array.from({length: 11}, (_, i) => Math.max(0, slope * (n + i) + intercept));
                };
                
                const projectedRevenues = calculate2026Projections(revenues);
                const projectedBookings = calculate2026Projections(bookings);
                const months2025 = months.map(m => m + ' 2025');
                const months2026 = months.map(m => m + ' 2026');
                const allMonths = [...months2025, ...months2026];
                
                if (combinedChartRef.current) {
                    if (combinedChartInstance.current) combinedChartInstance.current.destroy();
                    const ctx = combinedChartRef.current.getContext('2d');
                    combinedChartInstance.current = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: allMonths,
                            datasets: [
                                { label: 'Revenue 2025 (Actual)', data: [...revenues, ...Array(11).fill(null)], backgroundColor: 'rgba(255, 111, 0, 0.8)', borderColor: 'rgba(255, 111, 0, 1)', borderWidth: 2, borderRadius: 8, yAxisID: 'y' },
                                { label: 'Revenue 2026 (Projected)', data: [...Array(11).fill(null), ...projectedRevenues], backgroundColor: 'rgba(255, 111, 0, 0.3)', borderColor: 'rgba(255, 111, 0, 0.6)', borderWidth: 2, borderRadius: 8, borderDash: [5, 5], yAxisID: 'y' },
                                { label: 'Bookings 2025 (Actual)', data: [...bookings, ...Array(11).fill(null)], type: 'line', borderColor: '#2c3e50', backgroundColor: 'rgba(44, 62, 80, 0.1)', tension: 0.4, borderWidth: 3, fill: false, pointRadius: 5, pointBackgroundColor: '#2c3e50', pointBorderColor: '#fffcf2', pointBorderWidth: 2, yAxisID: 'y1' },
                                { label: 'Bookings 2026 (Projected)', data: [...Array(11).fill(null), ...projectedBookings], type: 'line', borderColor: '#2c3e50', backgroundColor: 'rgba(44, 62, 80, 0.1)', tension: 0.4, borderWidth: 3, borderDash: [5, 5], fill: false, pointRadius: 5, pointBackgroundColor: '#2c3e50', pointBorderColor: '#fffcf2', pointBorderWidth: 2, yAxisID: 'y1' }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: { mode: 'index', intersect: false },
                            plugins: {
                                legend: { display: true, labels: { color: '#2c3e50', font: { family: 'Outfit' } } },
                                tooltip: { backgroundColor: 'rgba(37, 36, 34, 0.95)', titleColor: '#ff6f00', bodyColor: '#fffcf2', borderColor: '#ccc5b9', borderWidth: 1, padding: 12, callbacks: { label: (ctx) => ctx.dataset.label.includes('Revenue') ? `${ctx.dataset.label}: $${ctx.parsed.y?.toLocaleString('en-US', {minimumFractionDigits: 2}) || 'N/A'}` : `${ctx.dataset.label}: ${ctx.parsed.y?.toFixed(0) || 'N/A'} bookings` } }
                            },
                            scales: {
                                x: { grid: { display: false }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono', size: 10 }, maxRotation: 45, minRotation: 45 } },
                                y: { type: 'linear', position: 'left', beginAtZero: true, grid: { color: '#ccc5b9' }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' }, callback: (value) => '$' + (value / 1000).toFixed(0) + 'K' }, title: { display: true, text: 'Revenue', color: '#ff6f00', font: { family: 'Outfit', size: 14, weight: 'bold' } } },
                                y1: { type: 'linear', position: 'right', beginAtZero: true, grid: { display: false }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' } }, title: { display: true, text: 'Bookings', color: '#2c3e50', font: { family: 'Outfit', size: 14, weight: 'bold' } } }
                            }
                        }
                    });
                }
                
                if (rpuChartRef.current) {
                    if (rpuChartInstance.current) rpuChartInstance.current.destroy();
                    const ctx = rpuChartRef.current.getContext('2d');
                    rpuChartInstance.current = new Chart(ctx, {
                        type: 'line',
                        data: { labels: months2025, datasets: [{ data: rpuValues, borderColor: '#ff6f00', backgroundColor: 'rgba(255, 111, 0, 0.1)', tension: 0.4, borderWidth: 3, fill: true, pointRadius: 6, pointBackgroundColor: '#ff6f00', pointBorderColor: '#fffcf2', pointBorderWidth: 2 }] },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { backgroundColor: 'rgba(37, 36, 34, 0.95)', titleColor: '#ff6f00', bodyColor: '#fffcf2', borderColor: '#ccc5b9', borderWidth: 1, padding: 12, callbacks: { label: (ctx) => `RPU: $${ctx.parsed.y.toFixed(2)}` } } }, scales: { x: { grid: { color: '#ccc5b9' }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' } } }, y: { beginAtZero: true, grid: { color: '#ccc5b9' }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' }, callback: (value) => '$' + value.toFixed(0) } } } }
                    });
                }
                
                if (vehicleChartRef.current) {
                    if (vehicleChartInstance.current) vehicleChartInstance.current.destroy();
                    const uniqueVehicles = data.map(d => d.uniqueVehicles);
                    const ctx = vehicleChartRef.current.getContext('2d');
                    vehicleChartInstance.current = new Chart(ctx, {
                        type: 'bar',
                        data: { labels: months2025, datasets: [{ data: uniqueVehicles, backgroundColor: 'rgba(204, 197, 185, 0.8)', borderColor: 'rgba(204, 197, 185, 1)', borderWidth: 2, borderRadius: 8 }] },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { backgroundColor: 'rgba(37, 36, 34, 0.95)', titleColor: '#ff6f00', bodyColor: '#fffcf2', borderColor: '#ccc5b9', borderWidth: 1, padding: 12, callbacks: { label: (ctx) => `${ctx.parsed.y} vehicles` } } }, scales: { x: { grid: { display: false }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' } } }, y: { beginAtZero: true, grid: { color: '#ccc5b9' }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' }, stepSize: 5 } } } }
                    });
                }
                
                if (trendChartRef.current) {
                    if (trendChartInstance.current) trendChartInstance.current.destroy();
                    const ctx = trendChartRef.current.getContext('2d');
                    trendChartInstance.current = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: months2025,
                            datasets: [
                                { label: 'Revenue', data: revenues, borderColor: '#ff6f00', backgroundColor: 'rgba(255, 111, 0, 0.1)', tension: 0.4, borderWidth: 3, fill: true, yAxisID: 'y' },
                                { label: 'RPU', data: rpuValues, borderColor: '#2c3e50', backgroundColor: 'rgba(44, 62, 80, 0.1)', tension: 0.4, borderWidth: 3, fill: true, yAxisID: 'y1' }
                            ]
                        },
                        options: { responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false }, plugins: { legend: { display: true, labels: { color: '#2c3e50', font: { family: 'Outfit' } } }, tooltip: { backgroundColor: 'rgba(37, 36, 34, 0.95)', titleColor: '#ff6f00', bodyColor: '#fffcf2', borderColor: '#ccc5b9', borderWidth: 1, padding: 12 } }, scales: { x: { grid: { color: '#ccc5b9' }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' } } }, y: { type: 'linear', position: 'left', beginAtZero: true, grid: { color: '#ccc5b9' }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' }, callback: (value) => '$' + (value / 1000).toFixed(0) + 'K' } }, y1: { type: 'linear', position: 'right', beginAtZero: true, grid: { display: false }, ticks: { color: '#2c3e50', font: { family: 'JetBrains Mono' }, callback: (value) => '$' + value.toFixed(0) } } } }
                    });
                }
            };
            
            const totalRevenue = data.reduce((sum, d) => sum + d.revenue, 0);
            const totalUniqueVehicles = Math.max(...data.map(d => d.uniqueVehicles), 0);
            const avgRPU = totalRevenue / data.reduce((sum, d) => sum + d.uniqueVehicles, 0) * data.length;
            const bestRPUMonth = data.length > 0 ? data.reduce((max, d) => { const rpu = d.revenue / d.uniqueVehicles; const maxRpu = max.revenue / max.uniqueVehicles; return rpu > maxRpu ? d : max; }, data[0]) : null;
            
            return (
                <div className="app-container">
                    <div className="background-grid"></div>
                    <div className="content-wrapper">
                        <div className="header animated">
                            <div className="header-content">
                                <img src="best-logo.jpg" alt="BEST Rent A Car" className="logo-img" />
                                <div className="header-text">
                                    <h1>BOOKING ANALYTICS</h1>
                                    <p>[ 2025 PERFORMANCE + 2026 PROJECTIONS ]</p>
                                </div>
                            </div>
                            <button className="upload-btn" onClick={() => fileInputRef.current.click()}>ðŸ“¤ Upload Data</button>
                            <input ref={fileInputRef} type="file" multiple accept=".xlsx,.xls" className="file-input" onChange={handleFileSelect} />
                        </div>
                        
                        {files.length > 0 && (
                            <div className="uploaded-files animated">
                                <h4 style={{marginBottom: '15px', color: 'var(--text-secondary)'}}>Uploaded Files:</h4>
                                {files.map((file, idx) => <span key={idx} className="file-tag">{file.name}</span>)}
                            </div>
                        )}
                        
                        {data.length > 0 ? (
                            <>
                                <div className="stats-grid animated">
                                    <div className="stat-card">
                                        <div className="stat-label">Total Revenue (2025)</div>
                                        <div className="stat-value">${(totalRevenue / 1000).toFixed(1)}K</div>
                                        <div className="stat-change">{data.length} months tracked</div>
                                    </div>
                                    <div className="stat-card highlight">
                                        <div className="stat-label">
                                            Revenue Per Unit
                                            <div className="tooltip-container">
                                                <span className="info-icon">â“˜</span>
                                                <div className="tooltip tooltip-multiline">
                                                    <span className="tooltip-formula">RPU = Total Revenue Ã· Unique Vehicles Used</span>
                                                    Measures revenue generated per physical car in your fleet
                                                </div>
                                            </div>
                                            <span className="rpu-badge">RPU</span>
                                        </div>
                                        <div className="stat-value">${avgRPU.toFixed(0)}</div>
                                        <div className="stat-change">{bestRPUMonth && `Best: ${bestRPUMonth.month} ($${(bestRPUMonth.revenue / bestRPUMonth.uniqueVehicles).toFixed(0)})`}</div>
                                    </div>
                                    <div className="stat-card">
                                        <div className="stat-label">Fleet Size (Peak)</div>
                                        <div className="stat-value">{totalUniqueVehicles}</div>
                                        <div className="stat-change">Unique vehicles used</div>
                                    </div>
                                </div>
                                
                                <div className="charts-container animated">
                                    <div className="chart-card full-width">
                                        <div className="chart-header">
                                            <div>
                                                <div className="chart-title">Revenue & Bookings: 2025 Actual + 2026 Projected</div>
                                                <div className="chart-subtitle">Month-over-month performance with linear projections</div>
                                            </div>
                                        </div>
                                        <div className="chart-wrapper"><canvas ref={combinedChartRef}></canvas></div>
                                    </div>
                                </div>
                                
                                <div className="charts-container two-col animated">
                                    <div className="chart-card">
                                        <div className="chart-header">
                                            <div>
                                                <div className="chart-title">RPU Trend (2025)<span className="rpu-badge">Key Metric</span></div>
                                                <div className="chart-subtitle">Revenue per vehicle over time</div>
                                            </div>
                                        </div>
                                        <div className="chart-wrapper"><canvas ref={rpuChartRef}></canvas></div>
                                    </div>
                                    <div className="chart-card">
                                        <div className="chart-header">
                                            <div>
                                                <div className="chart-title">Vehicle Utilization (2025)</div>
                                                <div className="chart-subtitle">Unique vehicles used per month</div>
                                            </div>
                                        </div>
                                        <div className="chart-wrapper"><canvas ref={vehicleChartRef}></canvas></div>
                                    </div>
                                    <div className="chart-card full-width">
                                        <div className="chart-header">
                                            <div>
                                                <div className="chart-title">Performance Overview (2025)</div>
                                                <div className="chart-subtitle">Revenue & RPU comparison</div>
                                            </div>
                                        </div>
                                        <div className="chart-wrapper"><canvas ref={trendChartRef}></canvas></div>
                                    </div>
                                </div>
                            </>
                        ) : (
                            <div className="empty-state">
                                <div className="empty-state-icon">ðŸ“ˆ</div>
                                <h3>No data yet</h3>
                                <p>Upload your Excel files to see analytics</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        }
        
        ReactDOM.render(<BookingAnalyticsPlatform />, document.getElementById('root'));
    </script>
</body>
</html>
